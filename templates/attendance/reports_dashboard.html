{% extends 'base.html' %}

{% block title %}Reports Dashboard - Temple Attendance{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2><i class="fas fa-chart-bar"></i> Reports & Analytics Dashboard</h2>
                <div class="badge bg-primary">Admin Only</div>
            </div>
        </div>
    </div>
    
    <div class="row g-4">
        <!-- Sabha-wise Report -->
        <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center">
                    <div class="mb-3">
                        <i class="fas fa-users fa-3x text-primary"></i>
                    </div>
                    <h5 class="card-title">Sabha-wise Reports</h5>
                    <p class="card-text">Attendance analytics by sabha type and date range</p>
                    <a href="{% url 'sabha_wise_report' %}" class="btn btn-primary">View Report</a>
                </div>
            </div>
        </div>
        
        <!-- Mandal-wise Report -->
        <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center">
                    <div class="mb-3">
                        <i class="fas fa-building fa-3x text-success"></i>
                    </div>
                    <h5 class="card-title">Mandal-wise Reports</h5>
                    <p class="card-text">Attendance summary by mandal organization</p>
                    <a href="{% url 'mandal_wise_report' %}" class="btn btn-success">View Report</a>
                </div>
            </div>
        </div>
        
        <!-- Xetra-wise Report -->
        <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center">
                    <div class="mb-3">
                        <i class="fas fa-map-marker-alt fa-3x text-warning"></i>
                    </div>
                    <h5 class="card-title">Xetra-wise Reports</h5>
                    <p class="card-text">Attendance summary by xetra regions</p>
                    <a href="{% url 'xetra_wise_report' %}" class="btn btn-warning">View Report</a>
                </div>
            </div>
        </div>
        
        <!-- Attendance Trends -->
        <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center">
                    <div class="mb-3">
                        <i class="fas fa-chart-line fa-3x text-info"></i>
                    </div>
                    <h5 class="card-title">Attendance Trends</h5>
                    <p class="card-text">Weekly/Monthly trends with charts</p>
                    <a href="{% url 'attendance_trends' %}" class="btn btn-info">View Trends</a>
                </div>
            </div>
        </div>
        
        <!-- Devotee History -->
        <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center">
                    <div class="mb-3">
                        <i class="fas fa-user-clock fa-3x text-secondary"></i>
                    </div>
                    <h5 class="card-title">Devotee History</h5>
                    <p class="card-text">Individual devotee attendance records</p>
                    <a href="{% url 'devotee_attendance_history' %}" class="btn btn-secondary">View History</a>
                </div>
            </div>
        </div>
        
        <!-- Export Options -->
        <div class="col-md-6 col-lg-4">
            <div class="card h-100 shadow-sm">
                <div class="card-body text-center">
                    <div class="mb-3">
                        <i class="fas fa-download fa-3x text-dark"></i>
                    </div>
                    <h5 class="card-title">Export Data</h5>
                    <p class="card-text">Download reports in Excel format</p>
                    <a href="#" class="btn btn-dark disabled">Export Excel</a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Quick Stats -->
    <div class="row mt-5">
        <div class="col-12">
            <h4>Quick Statistics</h4>
        </div>
        <div class="col-md-3">
            <div class="card bg-primary text-white">
                <div class="card-body">
                    <h5>Total Devotees</h5>
                    <h2 id="totalDevotees">-</h2>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-success text-white">
                <div class="card-body">
                    <h5>This Month Sabhas</h5>
                    <h2 id="monthSabhas">-</h2>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-info text-white">
                <div class="card-body">
                    <h5>Avg Attendance</h5>
                    <h2 id="avgAttendance">-</h2>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card bg-warning text-white">
                <div class="card-body">
                    <h5>Active Mandals</h5>
                    <h2 id="activeMandals">-</h2>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Load quick stats
fetch('/reports/quick-stats/')
    .then(response => response.json())
    .then(data => {
        document.getElementById('totalDevotees').textContent = data.total_devotees || 0;
        document.getElementById('monthSabhas').textContent = data.month_sabhas || 0;
        document.getElementById('avgAttendance').textContent = (data.avg_attendance || 0) + '%';
        document.getElementById('activeMandals').textContent = data.active_mandals || 0;
    })
    .catch(error => console.error('Error loading stats:', error));
</script>
{% endblock %}